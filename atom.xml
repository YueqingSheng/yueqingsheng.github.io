<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://yueqingsheng.github.io</id>
    <title>Random thoughts</title>
    <updated>2020-06-18T03:16:57.177Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://yueqingsheng.github.io"/>
    <link rel="self" href="https://yueqingsheng.github.io/atom.xml"/>
    <subtitle>Don&apos;t Learn to Code â€” Learn to Automate</subtitle>
    <logo>https://yueqingsheng.github.io/images/avatar.png</logo>
    <icon>https://yueqingsheng.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Random thoughts</rights>
    <entry>
        <title type="html"><![CDATA[Day 2 ä½œä¸šæ€è·¯]]></title>
        <id>https://yueqingsheng.github.io/post/day-2-zuo-ye-si-lu/</id>
        <link href="https://yueqingsheng.github.io/post/day-2-zuo-ye-si-lu/">
        </link>
        <updated>2020-06-14T12:20:09.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€æ­¥æŠŠ-q-table-çœ‹ä¸€ä¸‹">ç¬¬ä¸€æ­¥æŠŠ Q table çœ‹ä¸€ä¸‹</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592440727420.png" alt="" loading="lazy"><br>
16è¡Œ4åˆ—çš„np arrayï¼Œ æ¯ä¸€æ ¼ä¸ºQ(state, action)çš„å€¼</p>
<h2 id="sampleå’Œpredict-å°±æ˜¯epsilon-greedyç®—æ³•">sampleå’Œpredict:  å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">Ïµ</span></span></span></span>-greedyç®—æ³•</h2>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1592439809913.png" alt="" loading="lazy"></figure>
<h3 id="sample">sample</h3>
<p>åœ¨ 0-1 roll ä¸€ä¸ªæ•°ï¼Œå¦‚æœè¿™ä¸ªæ•°å°äºç­‰äº1- <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">Ïµ</span></span></span></span> å°±è§¦å‘argmaxäº‹ä»¶ï¼Œå¦åˆ™è§¦å‘éšæœºè¡ŒåŠ¨ã€‚</p>
<p>å¯èƒ½ä¼šç”¨åˆ°çš„å‡½æ•°ï¼š</p>
<blockquote>
<p>numpy.random.uniform(low=0.0, high=1.0, size=None)<br>
åœ¨ low åˆ° high èŒƒå›´å–sizeä¸ªæ ·æœ¬ï¼Œé»˜è®¤0åˆ°1å–ä¸€ä¸ªæ ·æœ¬</p>
</blockquote>
<blockquote>
<p>numpy.random.choice(a, size=None, replace=True, p=None)<br>
ä» a åˆ—è¡¨é‡Œéšæœºé€‰sizeä¸ªæ•°ï¼Œ aå¯ä»¥æ˜¯1ç»´åˆ—è¡¨æˆ–è€…int, intçš„è¯å°±æ˜¯ range(a)<br>
Parameters: a: If an ndarray, a random sample is generated from its elements. If an int, the random sample is generated as if a was np.arange(n)</p>
</blockquote>
<h3 id="predict">predict</h3>
<p>ä»ç¬¬ s/obs è¡Œï¼Œå– Q å€¼æœ€å¤§çš„ aã€‚=&gt; find the max index of valueï¼Œå³æ±‚æœ€å¤§å€¼çš„åæ ‡ã€‚<br>
å› ä¸ºæœ‰å¯èƒ½æœ‰å¤šä¸ªæœ€å¤§å€¼ï¼Œæˆ‘ä»¬ä¸æƒ³æ¯æ¬¡éƒ½èµ°åŒä¸€ä¸ªaction, æ‰€ä»¥ä»è¿™äº›æœ€å¤§å€¼çš„åæ ‡éšæœºå‡ºä¸€ä¸ªã€‚</p>
<p>å¯èƒ½ä¼šç”¨åˆ°çš„å‡½æ•°ï¼š</p>
<blockquote>
<p>ä» 2D Numpy Array é€‰æŸè¡Œï¼š  ndArray[row_index] æˆ–è€… ndArray[row_index, :]<br>
numpy.where(condition) è¾“å‡ºæ»¡è¶³æ¡ä»¶ ((condition)) å…ƒç´ çš„åæ ‡ (ç­‰ä»·äºnumpy.nonzero)ã€‚è¿™é‡Œçš„åæ ‡ä»¥tupleçš„å½¢å¼ç»™å‡ºã€‚</p>
</blockquote>
<p>è¿™é‡Œ np.where è¿”å›ç±»ä¼¼ (array([0, 1, 2, 3]),) å…ƒç»„è¿™ç§æ ¼å¼ã€‚æ‰€ä»¥ç”¨ä¸‹æ ‡å–å‡ºç¬¬ä¸€ä¸ªarray</p>
<h2 id="learn">learn</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592444105446.png" alt="" loading="lazy"><br>
è¿™é‡Œå°±æ˜¯å…ˆæŠŠæ–¹æ‹¬å·é‡Œçš„ç®—å‡ºæ¥ï¼Œå†ä¹˜ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span> åŠ ä¸ŠåŸæ¥çš„å€¼<br>
Q learning çš„ sample å’Œ predict å’Œ Sarsa å®Œå…¨ä¸€æ ·ï¼Œå”¯ä¸€å°±æ˜¯ æ›´æ–° Q çš„å…¬å¼ä¸åŒã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592428118258.png" alt="" loading="lazy"></p>
<h2 id="æ˜¾ç¤ºè§†å›¾">æ˜¾ç¤ºè§†å›¾</h2>
<p>æŠŠ test_episode é‡Œçš„è¿™ä¸¤è¡Œåæ³¨é‡Šæ‰<br>
<img src="https://yueqingsheng.github.io/post-images/1592449956397.png" alt="" loading="lazy"><br>
gridworld.py ä¸‹è½½åœ°å€ï¼šhttps://raw.githubusercontent.com/PaddlePaddle/PARL/develop/examples/tutorials/lesson1/gridworld.py</p>
<pre><code class="language-python">from gridworld import FrozenLakeWapper
env = gym.make(&quot;FrozenLake-v0&quot;, is_slippery=False) 
env = FrozenLakeWapper(env)
</code></pre>
<h2 id="é”™è¯¯no-display-name-and-no-display-environment-variable">é”™è¯¯ï¼šno display name and no $DISPLAY environment variable</h2>
<p>Jupyteræ²¡æœ‰çª—å£ç¯å¢ƒï¼Œè¦æœ¬åœ°è¿è¡Œï¼Œæˆ–è€…è¿œç¨‹terminalè·‘æ‰è¡Œ</p>
<h2 id="ç»“æœå±•ç¤º">ç»“æœå±•ç¤º</h2>
<h3 id="sarsa">Sarsa</h3>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1592448717310.gif" alt="" loading="lazy"></figure>
<h3 id="q-learning">Q-learning</h3>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1592449876779.gif" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¼ºåŒ–å­¦ä¹  Day 1]]></title>
        <id>https://yueqingsheng.github.io/post/qiang-hua-xue-xi/</id>
        <link href="https://yueqingsheng.github.io/post/qiang-hua-xue-xi/">
        </link>
        <updated>2020-06-14T08:41:16.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ ">ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ ï¼Ÿ</h2>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1592340187285.png" alt="" loading="lazy"></figure>
<h2 id="ä¸¤éƒ¨åˆ†-ä¸‰è¦ç´ ">ä¸¤éƒ¨åˆ† ä¸‰è¦ç´ </h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592340281494.png" alt="" loading="lazy"><br>
åœ¨ Flappy bird ä¸­</p>
<table>
<thead>
<tr>
<th>agent</th>
<th>environment</th>
<th>state</th>
<th>action</th>
<th>reward</th>
</tr>
</thead>
<tbody>
<tr>
<td>é¸Ÿ</td>
<td>é¸Ÿå‘¨å›´çš„ç¯å¢ƒï¼Œæ°´ç®¡ã€å¤©ç©ºï¼ˆåŒ…æ‹¬å°é¸Ÿæœ¬èº«ï¼‰</td>
<td>æ‹ä¸ªç…§ï¼ˆç›®å‰çš„åƒç´ ï¼‰</td>
<td>å‘ä¸Šå‘ä¸‹åŠ¨ä½œ</td>
<td>è·ç¦»ï¼ˆè¶Šè¿œå¥–åŠ±è¶Šé«˜ï¼‰</td>
</tr>
</tbody>
</table>
<p>åŠ¨ä¸€ä¸‹æˆªä¸ªå›¾ å†å†³å®šä¸‹ä¸€ä¸ªåŠ¨ä½œ<br>
è·Ÿç¯å¢ƒäº¤äº’ï¼Œå†³ç­–ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592341430929.png" alt="" loading="lazy"><br>
å¥–åŠ±æ˜¯å»¶è¿Ÿçš„ã€‚è¿·å®«èµ°å®Œï¼Œæ‰æœ‰å¥–åŠ±ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592341492276.png" alt="" loading="lazy"></p>
<h2 id="å¼ºåŒ–å­¦ä¹ å’Œå…¶ä»–æœºå™¨å­¦ä¹ çš„å…³ç³»">å¼ºåŒ–å­¦ä¹ å’Œå…¶ä»–æœºå™¨å­¦ä¹ çš„å…³ç³»</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592341779032.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592342011873.png" alt="" loading="lazy"><br>
ç›‘ç£æ ·æœ¬ä¸€èˆ¬æ ·æœ¬å†…æ— å…³ç³»ã€‚å¼ºåŒ–å­¦ä¹ ï¼Œæ ·æœ¬ä¹‹é—´ç›¸äº’å½±å“ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592342296638.png" alt="" loading="lazy"><br>
åŸºäºä»·å€¼ä¼šå‘å›ºå®šæ–¹å‘èµ°ï¼ŒåŸºäºç­–ç•¥éšæœºæ€§æ›´é«˜ä¸€äº›ã€‚</p>
<h2 id="rl-agent-environment-äº¤äº’æ¥å£">RL agent &lt;-&gt; environment äº¤äº’æ¥å£</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592343026454.png" alt="" loading="lazy"><br>
reset é‡ç½®<br>
render æ¸²æŸ“ç›®å‰<br>
step äº¤äº’ä¸€æ­¥</p>
<h3 id="step-è¾“å‡ºå‚æ•°">Step è¾“å‡ºå‚æ•°</h3>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1592342821467.png" alt="" loading="lazy"></figure>
<ol>
<li>1-36 ä½ç½®ï¼ˆ36æ ¼å†…çš„ä½ç½®ï¼‰</li>
<li>-1 reward(å¥–åŠ±ï¼Œæ¯èµ°ä¸€æ­¥ä¼šæœ‰æƒ©ç½šï¼Œç›®æ ‡æœ€å°‘æ­¥æ•°èµ°å®Œ)</li>
<li>true/false æ¸¸æˆæ˜¯å¦å®Œæˆ</li>
<li>info é¢å¤–ä¿¡æ¯</li>
</ol>
<h3 id="git-clone-depth1">git clone --depth=1</h3>
<blockquote>
<p>depth ç”¨äºæŒ‡å®šå…‹éš†æ·±åº¦ï¼Œä¸º 1 å³è¡¨ç¤ºåªå…‹éš†æœ€è¿‘ä¸€æ¬¡ commit. å¯ä»¥è§£å†³é¡¹ç›®è¿‡å¤§çš„é—®é¢˜</p>
</blockquote>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1592343683260.png" alt="" loading="lazy"></figure>
<p>æ‹“å±•ï¼š<a href="https://www.zhihu.com/question/23474039/answer/269526476">ä¸ºä»€ä¹ˆæœ‰äººè¯´ Python çš„å¤šçº¿ç¨‹æ˜¯é¸¡è‚‹å‘¢ï¼Ÿ</a></p>
<p>å›¾ç‰‡æ¥æºï¼š<a href="https://aistudio.baidu.com/aistudio/projectdetail/560767">PARL å¼ºåŒ–å­¦ä¹ å…¬å¼€è¯¾ Lesson1</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¼ºåŒ–å­¦ä¹  Day 2 Sarsa, Q-learning]]></title>
        <id>https://yueqingsheng.github.io/post/qiang-hua-xue-xi-day-2-sarsa-q-learning/</id>
        <link href="https://yueqingsheng.github.io/post/qiang-hua-xue-xi-day-2-sarsa-q-learning/">
        </link>
        <updated>2020-06-14T05:57:25.000Z</updated>
        <content type="html"><![CDATA[<h2 id="å¼ºåŒ–å­¦ä¹ mdpå››å…ƒç»„s-a-p-r">å¼ºåŒ–å­¦ä¹ MDPå››å…ƒç»„&lt;S, A, P, R&gt;</h2>
<p>å¼ºåŒ–å­¦ä¹ æ˜¯è§£å†³è·Ÿæ—¶é—´ç›¸å…³çš„åºåˆ—å†³ç­–é—®é¢˜ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592416960594.png" alt="" loading="lazy"></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>[</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">p[s_{t+1}, r_{t} | s_{t}, a_{t}]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mtext>åœ¨</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>s</mi><mi>t</mi></msub></mstyle><mtext>æ—¶åˆ»ï¼Œé€‰æ‹©</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mi>t</mi></msub></mstyle><mtext>åŠ¨ä½œçš„æ—¶å€™ï¼Œè½¬ç§»åˆ°</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mstyle><mtext>Â è€Œä¸”æ‹¿åˆ°Â </mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>r</mi><mi>t</mi></msub></mstyle><mtext>å¥–åŠ±</mtext></mrow><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">æ¦‚</mi><mi mathvariant="normal">ç‡</mi></mrow><annotation encoding="application/x-tex">\text{åœ¨$s_ t$æ—¶åˆ»ï¼Œé€‰æ‹©$a_t$åŠ¨ä½œçš„æ—¶å€™ï¼Œè½¬ç§»åˆ°$s_{t+1}$ è€Œä¸”æ‹¿åˆ° $r_{t}$å¥–åŠ±}çš„æ¦‚ç‡
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord text"><span class="mord cjk_fallback">åœ¨</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">æ—¶åˆ»ï¼Œé€‰æ‹©</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">åŠ¨ä½œçš„æ—¶å€™ï¼Œè½¬ç§»åˆ°</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">Â </span><span class="mord cjk_fallback">è€Œä¸”æ‹¿åˆ°</span><span class="mord">Â </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">å¥–åŠ±</span></span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ¦‚</span><span class="mord cjk_fallback">ç‡</span></span></span></span></span></p>
<blockquote>
<p>é©¬å°”å¯å¤«æ€§è´¨: å½“å‰æ—¶åˆ»çš„çŠ¶æ€ä»…ä¸å‰ä¸€æ—¶åˆ»çš„çŠ¶æ€å’ŒåŠ¨ä½œæœ‰å…³ï¼Œä¸å…¶ä»–æ—¶åˆ»çš„çŠ¶æ€å’ŒåŠ¨ä½œæ¡ä»¶ç‹¬ç«‹ã€‚</p>
</blockquote>
<blockquote>
<p>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMarkov Decision Process, MDPï¼‰æ˜¯åºè´¯å†³ç­–ï¼ˆsequential decisionï¼‰çš„æ•°å­¦æ¨¡å‹ï¼Œç”¨äºåœ¨ç³»ç»ŸçŠ¶æ€å…·æœ‰é©¬å°”å¯å¤«æ€§è´¨çš„ç¯å¢ƒä¸­æ¨¡æ‹Ÿæ™ºèƒ½ä½“å¯å®ç°çš„éšæœºæ€§ç­–ç•¥ä¸å›æŠ¥</p>
</blockquote>
<p><img src="https://yueqingsheng.github.io/post-images/1592419241042.png" alt="" loading="lazy"><br>
På‡½æ•°ï¼šéšæœºæ€§ï¼Œè½¬ç§»åˆ°å¦å¤–ä¸€ç§çŠ¶æ€çš„æ¦‚ç‡<br>
Rå‡½æ•°ï¼šå¥–åŠ±å‡½æ•°</p>
<h2 id="model-based-vs-model-free">Model-based vs Model-free</h2>
<p>Model based: å¦‚æœ P, R å·²çŸ¥ï¼Œåˆ™ç¯å¢ƒæ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è®¡ç®—æœ€ä¼˜æ–¹æ¡ˆã€‚<br>
Model free: å½“è§£å†³æœªçŸ¥æˆ–éšæœºçš„ç¯å¢ƒæ—¶ï¼Œå³ P, R æœªçŸ¥ï¼Œå¯ä»¥ä½¿ç”¨å¼ºåŒ–å­¦ä¹ ã€‚</p>
<h2 id="q-å‡½æ•°">Q å‡½æ•°</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592419978987.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592420512413.png" alt="" loading="lazy"><br>
Qçš„ç›®æ ‡æ˜¯æœªæ¥çš„æ€»æ”¶ç›Š<br>
<img src="https://yueqingsheng.github.io/post-images/1592420605219.png" alt="" loading="lazy"><br>
ä½†æ˜¯å½“æ—¶é—´è¿‡é•¿æ—¶ï¼Œéœ€è¦åŠ ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">Î³</span></span></span></span> è¡°å‡ç³»æ•°ï¼Œæ—¶é—´è¶Šä¹…ï¼Œå¯¹å½“å‰çš„æ”¶ç›Šå½±å“è¶Šå°</p>
<h2 id="æ›´æ–°qè¡¨æ ¼">æ›´æ–°Qè¡¨æ ¼</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592421245188.png" alt="" loading="lazy"><br>
ä¸‹ä¸ªçŠ¶æ€çš„ä»·å€¼å¯ä»¥ç”¨æ¥å¼ºåŒ–ä¸Šä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼ï¼Œå¦‚ç»“åˆé£Ÿç‰©å’Œé“ƒå£°ä¸€èµ·å½±å“ç‹—çš„é£Ÿæ¬²ï¼ˆæµå£æ°´ï¼‰ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592422219338.jpg" alt="" loading="lazy"><br>
è¿™ä¸ªå…¬å¼å…¶å®å°±æ˜¯æŠŠæ¯ä¸€æ­¥çš„æ”¶ç›Šé€¼è¿‘äºæœªæ¥æ”¶ç›Šä¹‹å’Œï¼Œå³èµ°åˆ°è¿™ä¸€æ­¥è·å¾—çš„æ€»æ”¶ç›Šã€‚æ¯ä¸€æ¬¡å‘ç›®æ ‡å€¼çš„æ–¹å‘æ›´æ–°ä¸€ç‚¹ã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592422876957.png" alt="" loading="lazy"><br>
æ¯æ¬¡è·³è½¬åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œé€šè¿‡è¿™äº›Sarsaå‚æ•°ï¼Œä¾¿å¯å¾—çŸ¥å½“å‰çŠ¶æ€çš„Q valueã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1592423174750.png" alt="" loading="lazy"><br>
ç®—æ³•ï¼šæ¯èµ°ä¸€æ­¥ï¼Œå…ˆé€‰å‡ºè¦åšçš„åŠ¨ä½œã€‚å†èµ°ä¸‹ä¸€æ­¥ï¼Œé€šè¿‡çŠ¶æ€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä»Qè¡¨æ‹¿åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">a_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, ç„¶åé€šè¿‡ä¸‹ä¸€æ­¥å’Œä¸Šä¸€æ­¥çš„å‚æ•°æ›´æ–° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s_1, a_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<h3 id="å¦‚ä½•é€šè¿‡çŠ¶æ€-s-å»å–å‡ºåŠ¨ä½œ-a-epsilon-greedy">å¦‚ä½•é€šè¿‡çŠ¶æ€ s å»å–å‡ºåŠ¨ä½œ a ï¼Ÿ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">Ïµ</span></span></span></span>-greedy</h3>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1592424271702.png" alt="" loading="lazy"></figure>
<h2 id="sarsa-ä»£ç ">Sarsa ä»£ç </h2>
<p><img src="https://lh6.googleusercontent.com/8jhtLe0-rCvlm69sSpofk5eh3g1hpOmFgBFQPLQKTgw7iUN8d6-mHxrx4JjnQGKI6AwDzpMiePXbNRU1O-NeDy6ER9QWMLjF2IHDDc_BTGKff--BNUZU9iw8QubW3nnBz6Qls7tT" alt="" loading="lazy"><br>
<a href="https://aistudio.baidu.com/aistudio/projectdetail/567852">paddleå®ç°é“¾æ¥</a></p>
<h2 id="off-policy">Off-Policy</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592427661829.png" alt="" loading="lazy"><br>
Off-Policy ä¸å’Œç¯å¢ƒäº¤äº’</p>
<h2 id="q-learning">Q-learning</h2>
<figure data-type="image" tabindex="2"><img src="https://i.stack.imgur.com/JE6BY.png" alt="" loading="lazy"></figure>
<h2 id="q-learning-vs-sarsa">Q-learning vs Sarsa</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592427877376.png" alt="" loading="lazy"><br>
Q-learning çš„ä¸‹ä¸ªçŠ¶æ€é€‰å–ä½¿Qæœ€å¤§çš„action<br>
<img src="https://yueqingsheng.github.io/post-images/1592428118258.png" alt="" loading="lazy"></p>
<h2 id="off-policy-vs-on-policy">Off-Policy vs On-policy</h2>
<blockquote>
<p>policy: ç­–ç•¥æ˜¯æŒ‡é€šè¿‡çŠ¶æ€ s å»å–å‡ºåŠ¨ä½œ a çš„ æ–¹æ³•/æ¦‚ç‡ã€‚Policy specifies an action ğ‘, that is taken in a state ğ‘  (or more precisely, ğœ‹ is a probability, that an action ğ‘ is taken in a state ğ‘ ).</p>
</blockquote>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1592428550500.png" alt="" loading="lazy"></figure>
<blockquote>
<p>è¡Œä¸ºç­–ç•¥ï¼šç”¨æ¥ä¸ç¯å¢ƒäº’åŠ¨æ”¶é›†æƒ…æŠ¥ã€äº§ç”Ÿæ•°æ®çš„ç­–ç•¥ï¼Œå³è®­ç»ƒè¿‡ç¨‹ä¸­çš„ç­–ç•¥ã€‚ Ï€(a|s)<br>
ç›®æ ‡ç­–ç•¥ï¼šåœ¨è¡Œä¸ºç­–ç•¥äº§ç”Ÿçš„æ•°æ®ä¸­ä¸æ–­å­¦ä¹ å’Œä¼˜åŒ–å¾—åˆ°çš„ç­–ç•¥ï¼Œå³å­¦ä¹ è®­ç»ƒå®Œæ¯•åæ‹¿å»åšè¡Œä¸ºè¯„ä¼°çš„ç­–ç•¥ã€‚Âµ(a|s)</p>
</blockquote>
<p>åŒºåˆ«æ˜¯</p>
<blockquote>
<p>on-policy é€šè¿‡çš„ä¸ç¯å¢ƒäº¤äº’çš„ç»éªŒæ›´æ–°Q, æŒ‰ä»¥å¾€ç»éªŒæ¥ã€‚ off-policy å°±ä¸ç®¡ä¹‹å‰ç»éªŒäº†ï¼Œé€šè¿‡ä»»æ„æ–¹å¼è·å–action, æ¯”å¦‚ greedyã€‚</p>
</blockquote>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592431533553.png" alt="" loading="lazy"><br>
On policy å¯¹äºä¿ç•™ç›®å‰æ¢ç´¢çš„æˆæœæœ‰å¥½å¤„ ï¼Œä½†å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚ä¸å¤Ÿå†’é™©ã€‚<br>
Off policy å¤Ÿå†’é™©ï¼Œå®¹æ˜“è¾¾åˆ°å…¨å±€æœ€ä¼˜ï¼Œä½†æ”¶æ•›æ›´æ…¢ï¼Œè¯•é”™æ›´å¤šï¼Œä¸é€‚åˆç°å®ä¸­è¯•é”™æˆæœ¬å¤ªå¤§çš„å°è¯•ã€‚</p>
<h2 id="æ‹“å±•">æ‹“å±•ï¼š</h2>
<p><a href="https://analyticsindiamag.com/reinforcement-learning-policy/">ON-POLICY VS OFF-POLICY REINFORCEMENT LEARNING</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç³»ç»Ÿè®¾è®¡5 åŸºäºåœ°ç†ä½ç½®çš„ä¿¡æ¯ç³»ç»Ÿï¼ˆLocation based service)]]></title>
        <id>https://yueqingsheng.github.io/post/xi-tong-she-ji-5-ji-yu-di-li-wei-zhi-de-xin-xi-xi-tong-location-based-service/</id>
        <link href="https://yueqingsheng.github.io/post/xi-tong-she-ji-5-ji-yu-di-li-wei-zhi-de-xin-xi-xi-tong-location-based-service/">
        </link>
        <updated>2020-06-12T02:09:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="rpcremote-procedure-call">RPC(remote procedure call)</h2>
<p>ä¸åŒçš„æœºå™¨ä¹‹é—´è°ƒç”¨å‡½æ•°<br>
httpåŒ…å«äº†å¾ˆå¤šéªŒè¯ä¿¡æ¯, ä¸é«˜æ•ˆ</p>
<h2 id="google-s2ä½ç½®å‚¨å­˜-æŸ¥è¯¢ç³»ç»Ÿ">Google S2(ä½ç½®å‚¨å­˜ æŸ¥è¯¢ç³»ç»Ÿ)</h2>
<p>System design = logic design + infrastructure design(æ¶æ„è®¾è®¡)</p>
<h2 id="scenario">Scenario</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1592234676481.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592235236181.png" alt="" loading="lazy"><br>
æ”¶é›†ç”¨æˆ·ä¿¡æ¯ï¼Œé¢„æµ‹æ‰“è½¦æ¦‚ç‡ã€‚</p>
<h2 id="service">Service</h2>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1592239148033.png" alt="" loading="lazy"></figure>
<h2 id="storage">Storage</h2>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1592246122954.png" alt="" loading="lazy"></figure>
<h3 id="trip-tableå•">Trip Table:ï¼ˆå•ï¼‰</h3>
<p>è¯»å¤šå†™å°‘ æ¯å››ç§’æŸ¥ä¸€æ¬¡é™„è¿‘çš„æ¥å•ä¿¡æ¯</p>
<h3 id="location-table">Location Table:</h3>
<p>è¯»å°‘å†™å¤š æ¯å››ç§’å†™ä¸€æ¬¡driver location</p>
<h2 id="èŒƒå›´æŸ¥è¯¢">èŒƒå›´æŸ¥è¯¢</h2>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1592247699767.png" alt="" loading="lazy"></figure>
<h2 id="äºŒç»´æŸ¥è¯¢æ˜ å°„åˆ°ä¸€ç»´">äºŒç»´æŸ¥è¯¢æ˜ å°„åˆ°ä¸€ç»´</h2>
<h3 id="google-s2">Google S2</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1592247980056.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592248137315.png" alt="" loading="lazy"></p>
<h3 id="geohash">Geohash</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1592248499067.png" alt="" loading="lazy"><br>
æŸ¥çœ‹å…¬å…±å‰ç¼€ç›¸ä¼¼åº¦ï¼Œ32ä»½ï¼Œ<br>
<strong>ä¸ºä»€ä¹ˆæ˜¯ 1ï¼š2ï¼Ÿ</strong><br>
4 * 8ï¼ˆ180ï¼Œ360ï¼‰çº¬ç»åº¦æ¯”<br>
<strong>ä¸ºä»€ä¹ˆä¸Šä¸‹æ–¹ä¸¤è¡Œé•¿ï¼Ÿ</strong><br>
å› ä¸ºåœ°çƒæ˜¯åœ†çš„ï¼Œä¸Šä¸‹å çš„é¢ç§¯ç›¸å½“äºä¸‰è§’å½¢<br>
<strong>ä¸ºä»€ä¹ˆæ˜¯ 4*8?</strong><br>
<img src="https://yueqingsheng.github.io/post-images/1592249368751.png" alt="" loading="lazy"><br>
ç¼ºé™·  ï¼šåˆšå¥½åœ¨çº¿ä¸Šï¼Œçº¿ä¸¤è¾¹å·®è·å¤§</p>
<h4 id="æŸ¥è¯¢-google-åŠå¾„ä¸¤å…¬é‡Œä»¥å†…çš„è½¦">æŸ¥è¯¢ Google åŠå¾„ä¸¤å…¬é‡Œä»¥å†…çš„è½¦</h4>
<p>geohash LIKE 9q9hv%, %åˆ†å·åœ¨åé¢ï¼Œè¡¨ç¤ºä»¥9q9hvå¼€å¤´<br>
<img src="https://yueqingsheng.github.io/post-images/1592249754838.png" alt="" loading="lazy"><br>
Redis value: set åˆ é™¤ O(1) list åˆ é™¤O(n)</p>
<h2 id="åŒ¹é…">åŒ¹é…</h2>
<figure data-type="image" tabindex="4"><img src="https://yueqingsheng.github.io/post-images/1592251096560.png" alt="" loading="lazy"></figure>
<h2 id="scale">Scale</h2>
<p>è¿ç§»æˆæœ¬ä½ï¼ŒæŸå¤±æˆæœ¬å¤§ã€‚å•ç‚¹ Failure</p>
<h3 id="db-sharding">DB sharding</h3>
<p>æŒ‰Geo hash å‰å››ä½<br>
Uber ä½¿ç”¨åŸå¸‚ Sharding</p>
<h4 id="å®šä¹‰åŸå¸‚">å®šä¹‰åŸå¸‚</h4>
<p>Geo Fence<br>
æ±‚ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…<br>
<img src="https://yueqingsheng.github.io/post-images/1592251619394.png" alt="" loading="lazy"><br>
ä¹˜å®¢åœ¨è¾¹ç•Œä¸Šï¼Œè®°å½•åŸå¸‚è¿æ¥å…³ç³»</p>
<h4 id="æœºåœº">æœºåœº</h4>
<p>å…ˆæ‰¾åˆ°åŸå¸‚ï¼Œå†æŸ¥è¯¢ airport fence</p>
<h5 id="å‡å°‘é£é™©">å‡å°‘é£é™©</h5>
<ol>
<li>Master slave</li>
<li>æ¢æ•°æ®åº“Riak</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[nestjs ç»Ÿä¸€è¿”å›æ ¼å¼]]></title>
        <id>https://yueqingsheng.github.io/post/nestjs-tong-yi-fan-hui-ge-shi/</id>
        <link href="https://yueqingsheng.github.io/post/nestjs-tong-yi-fan-hui-ge-shi/">
        </link>
        <updated>2020-06-11T12:40:09.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç»Ÿä¸€è¿”å›æ ¼å¼">ç»Ÿä¸€è¿”å›æ ¼å¼</h2>
<p>ï½›dataï¼šobjectï¼Œmessageï¼šè¯·æ±‚æˆåŠŸï¼Œcodeï¼š200ï½</p>
<h2 id="æˆåŠŸçš„æ ¼å¼">æˆåŠŸçš„æ ¼å¼</h2>
<pre><code class="language-json">{
 &quot;statusCode&quot;: 200,
  &quot;data&quot;: {
    &quot;username&quot;: &quot;string&quot;,
    &quot;access_token&quot;: &quot;XXX&quot;
  },
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;è¯·æ±‚æˆåŠŸ&quot;
}
</code></pre>
<h2 id="å¤±è´¥çš„æ ¼å¼">å¤±è´¥çš„æ ¼å¼</h2>
<pre><code class="language-json">{
  &quot;statusCode&quot;: 401,
  &quot;data&quot;: {
    &quot;error&quot;: &quot;Client Error&quot;
  },
  &quot;message&quot;: &quot;è¯·æ±‚å¤±è´¥&quot;,
  &quot;code&quot;: 1,
  &quot;url&quot;: &quot;/api/auth/profile&quot;
}
</code></pre>
<p>æš‚å®šcodeä»£è¡¨æˆåŠŸï¼Œ1ä»£è¡¨å¤±è´¥ï¼ŒæˆåŠŸdataé‡Œæ˜¯è¿”å›å†…å®¹ï¼Œå¤±è´¥dataé‡Œæ˜¯é”™è¯¯ä¿¡æ¯ã€‚</p>
<h1 id="æ‹¦æˆªå…¨éƒ¨çš„é”™è¯¯è¯·æ±‚">æ‹¦æˆªå…¨éƒ¨çš„é”™è¯¯è¯·æ±‚</h1>
<p>src/core/filters/all-exception.filterâ€™;</p>
<pre><code class="language-typescript">import { ArgumentsHost, Catch, ExceptionFilter, HttpException, HttpStatus } from '@nestjs/common';
import { Request, Response } from 'express';
@Catch()
export class AllExceptionFilter&lt;T&gt; implements ExceptionFilter {
  catch(exception: HttpException, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse&lt;Response&gt;();
    const request = ctx.getRequest&lt;Request&gt;();
    const status =
      exception instanceof HttpException
        ? exception.getStatus()
        : HttpStatus.INTERNAL_SERVER_ERROR;

    const message = exception.message.message
      ? exception.message.message
      : `${status &gt;= 500 ? 'Service Error' : 'Client Error'}`;
    const errorResponse = {
      statusCode: status,
      data: { error: message },
      message: 'è¯·æ±‚å¤±è´¥',
      code: 1, // è‡ªå®šä¹‰code
    };
    // è®¾ç½®è¿”å›çš„çŠ¶æ€ç ã€è¯·æ±‚å¤´ã€å‘é€é”™è¯¯ä¿¡æ¯
    response.status(status);
    response.header('Content-Type', 'application/json; charset=utf-8');
    response.send(errorResponse);
  }
}
</code></pre>
<h1 id="æ‹¦æˆªæˆåŠŸçš„è¿”å›æ•°æ®">æ‹¦æˆªæˆåŠŸçš„è¿”å›æ•°æ®</h1>
<p>src/core/interceptors/response.interceptorâ€™;</p>
<pre><code class="language-typescript">import {
  CallHandler,
  ExecutionContext,
  Injectable,
  NestInterceptor,
} from '@nestjs/common';
import { Observable } from 'rxjs';
import { map } from 'rxjs/operators';
import { Response } from 'express';
@Injectable()
export class ResponseInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {
    const response = context.switchToHttp().getResponse&lt;Response&gt;();
    console.log(response.statusCode);
    return next.handle().pipe(
      map(data =&gt; {
        return {
          data,
          code: 0,
          message: 'è¯·æ±‚æˆåŠŸ',
          statusCode: response.statusCode,
        };
      }),
    );
  }
}
</code></pre>
<h1 id="å…¨å±€æ³¨å†Œ">å…¨å±€æ³¨å†Œ</h1>
<p>main.ts</p>
<pre><code class="language-typescript">...
import { TransformInterceptor } from './core/interceptor/transform.interceptor';

async function bootstrap() {
  ...
  // å…¨å±€æ³¨å†Œæ‹¦æˆªå™¨
  app.useGlobalFilters(new AllExceptionFilter());
  app.useGlobalInterceptors(new ResponseInterceptor());
  ...
}
bootstrap();
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç³»ç»Ÿè®¾è®¡4 APIè®¾è®¡å’ŒçŸ­ç½‘å€]]></title>
        <id>https://yueqingsheng.github.io/post/xi-tong-she-ji-4-duan-lian-jie/</id>
        <link href="https://yueqingsheng.github.io/post/xi-tong-she-ji-4-duan-lian-jie/">
        </link>
        <updated>2020-06-10T07:55:26.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç½‘ç«™ç³»ç»ŸåŸŸå">ç½‘ç«™ç³»ç»Ÿï¼ŒåŸŸå</h2>
<h3 id="è®¿é—®google">è®¿é—®Google</h3>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1592078252769.png" alt="" loading="lazy"></figure>
<ol>
<li>You type maps.google.com into the address bar of your browser.</li>
<li>The browser checks the cache for a DNS record to find the corresponding IP address of maps.google.com.</li>
<li>The browser sends an HTTP request to the webserver.</li>
<li>webserver =&gt; http server(Apache, nginx)</li>
<li>http server =&gt; WebApplication(Django, nodejs)</li>
<li>webapplication response<br>
<img src="https://yueqingsheng.github.io/post-images/1592079735308.png" alt="" loading="lazy"></li>
</ol>
<h2 id="api-è®¾è®¡">API è®¾è®¡</h2>
<p>ç›´æ¥ä½¿ç”¨user idæ˜¯ä¸å®‰å…¨çš„ï¼Œæ­£ç¡®æ–¹å¼æ˜¯é€šè¿‡ç™»é™†åçš„tokenè·å–id<br>
<img src="https://yueqingsheng.github.io/post-images/1592083213524.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592083280425.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592083338439.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592087205505.png" alt="" loading="lazy"></p>
<h3 id="news-feed-list-web-api">News Feed List Web Api</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1592088686604.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592088214530.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592088839355.png" alt="" loading="lazy"></p>
<h3 id="ç¿»é¡µ-pagination">ç¿»é¡µ Pagination</h3>
<p>å¤šè¯·æ±‚ä¸€ä¸ª page_size = n + 1, max_id = the last item id, real displayed = n items<br>
<img src="https://yueqingsheng.github.io/post-images/1592090634903.png" alt="" loading="lazy"></p>
<h4 id="refresh">refresh</h4>
<p>find items id &gt; max_id (latest)</p>
<h3 id="mention">Mention</h3>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1592114459940.png" alt="" loading="lazy"></figure>
<h4 id="ç›´æ¥è¿”å›aç¼ºç‚¹">ç›´æ¥è¿”å›<a>ç¼ºç‚¹</h4>
<p><img src="https://yueqingsheng.github.io/post-images/1592114602952.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592114695897.png" alt="" loading="lazy"></p>
<h2 id="çŸ­ç½‘å€">çŸ­ç½‘å€</h2>
<h3 id="service">Service</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1592116210957.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592116301504.png" alt="" loading="lazy"></p>
<h3 id="è½¬æ¢ç®—æ³•">è½¬æ¢ç®—æ³•</h3>
<p>éšæœºç”Ÿæˆå»é‡<br>
<img src="https://yueqingsheng.github.io/post-images/1592116830654.png" alt="" loading="lazy"></p>
<h4 id="sql">SQL</h4>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1592153139387.png" alt="" loading="lazy"></figure>
<h4 id="nosql">NoSQL</h4>
<figure data-type="image" tabindex="4"><img src="https://yueqingsheng.github.io/post-images/1592153194128.png" alt="" loading="lazy"></figure>
<h3 id="scale">Scale</h3>
<h4 id="ä¼˜åŒ–-response-time">ä¼˜åŒ– response time</h4>
<ol>
<li>Use Cache</li>
<li>åœ°ç†ä½ç½®æé€Ÿ<br>
centralized mysql + distributed memcached<br>
<img src="https://yueqingsheng.github.io/post-images/1592163807150.png" alt="" loading="lazy"></li>
</ol>
<h3 id="ä¸€å°æ•°æ®åº“æœåŠ¡å™¨æä¸å®š">ä¸€å°æ•°æ®åº“æœåŠ¡å™¨æä¸å®š</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1592185289011.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1592185509180.png" alt="" loading="lazy"></p>
<h2 id="ç»ƒä¹ -custom-url-è‡ªå®šä¹‰é“¾æ¥-è½¬-longurl">ç»ƒä¹  Custom url (è‡ªå®šä¹‰é“¾æ¥ è½¬ longurl)</h2>
<p>è‡ªå¢Idæ³•ï¼š å•ç‹¬åˆ›å»ºä¸€ä¸ª cutsom url -&gt; longurl æ•°æ®è¡¨<br>
éšæœºç”Ÿæˆæ³•ï¼š ç›´æ¥å­˜å‚¨ custom url</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç³»ç»Ÿè®¾è®¡ 3 sharding&hash]]></title>
        <id>https://yueqingsheng.github.io/post/xi-tong-she-ji-3-databaseandhash/</id>
        <link href="https://yueqingsheng.github.io/post/xi-tong-she-ji-3-databaseandhash/">
        </link>
        <updated>2020-06-07T15:56:36.000Z</updated>
        <content type="html"><![CDATA[<h2 id="scale">Scale</h2>
<h3 id="qps">QPS</h3>
<h3 id="single-point-failureä¸€å°æœåŠ¡å™¨æŒ‚">Single point failure(ä¸€å°æœåŠ¡å™¨æŒ‚)</h3>
<h4 id="sharding-æ•°æ®æ‹†åˆ†">sharding æ•°æ®æ‹†åˆ†</h4>
<ol>
<li>è§£å†³ single point failure</li>
<li>åˆ†æ‘Šæµé‡</li>
</ol>
<h4 id="replica-æ•°æ®å¤åˆ¶">replica æ•°æ®å¤åˆ¶</h4>
<ol>
<li>æ•°æ®æ¢å¤</li>
<li>åˆ†æ‘Šæµé‡</li>
</ol>
<h2 id="æ•°æ®åº“æ‹†åˆ†">æ•°æ®åº“æ‹†åˆ†</h2>
<h2 id="ç«–å‘æ‹†åˆ†">ç«–å‘æ‹†åˆ†</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591722453484.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591722492145.png" alt="" loading="lazy"><br>
ç¼ºç‚¹ï¼š å½“è¡¨å•ç‰¹åˆ«å¤§ï¼Œcolumnæ— æ³•æ‹†åˆ†æ—¶æ— æ³•ç”¨</p>
<h2 id="æ¨ªå‘æ‹†åˆ†">æ¨ªå‘æ‹†åˆ†</h2>
<p><strong>æ–°æ•°æ®æ”¾æ–°æœºå™¨ï¼Œè€æ•°æ®æ”¾è€æœºå™¨çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>
æ ¹æ®æ•°æ®çš„æ–°æ—§ç¨‹åº¦æ¥æ‹†åˆ†çš„è¯ï¼Œæ–°æ•°æ®çš„è®¿é—®æ¬¡æ•°æ¯”æ—§æ•°æ®çš„è®¿é—®æ¬¡æ•°æ˜¯è¦æ˜æ˜¾å¤šçš„ï¼Œä¼šå¯¼è‡´æ•°æ®è®¿é—®ä¸å‡åŒ€çš„é—®é¢˜ã€‚<br>
è¿™ç§æ–¹æ³•å¹¶ä¸ä¼šå¯¼è‡´å­˜å‚¨ä¸å‡åŒ€ï¼Œæœ€å¤šåªæœ‰æœ€æ–°çš„ä¸€å°æœºå™¨çš„æ•°æ®ç›¸å¯¹å°‘ä¸€äº›ï¼Œå…¶ä»–çš„æœºå™¨éƒ½è¿˜æ˜¯å‡åŒ€çš„ã€‚ä¹Ÿä¸ä¼šå¯¼è‡´ä¸çŸ¥é“æ•°æ®å»å“ªå°æœºå™¨å–ï¼Œæ¯”å¦‚æ ¹æ® id æ¥æ‹†åˆ†ï¼Œ0~99åœ¨1å·æœºå™¨ï¼Œ1-199 åœ¨2å·æœºå™¨çš„è¯ï¼Œæ ¹æ® id å¯ä»¥ç®—å‡ºå¯¹åº”çš„æœºå™¨æ˜¯å“ªä¸ª<br>
<img src="https://yueqingsheng.github.io/post-images/1591722936674.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591722974334.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591723056231.png" alt="" loading="lazy"><br>
75%çš„æ•°æ®è¿ç§»</p>
<h2 id="ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•">ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591724662966.png" alt="" loading="lazy"><br>
åŒ€èµ°ç›¸é‚»ä¸¤å°æœºå™¨çš„ä¸€éƒ¨åˆ†æ•°æ®</p>
<h3 id="ç¼ºé™·">ç¼ºé™·ï¼š</h3>
<p><img src="https://yueqingsheng.github.io/post-images/1591724873965.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591724909043.png" alt="" loading="lazy"></p>
<h2 id="æ”¹è¿›">æ”¹è¿›ï¼š</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591725237232.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591725356209.png" alt="" loading="lazy"><br>
çº¢é»‘æ ‘ï¼ˆbalanced treeï¼‰</p>
<h2 id="æ•°æ®å¤åˆ¶-replica">æ•°æ®å¤åˆ¶ Replica</h2>
<h3 id="replica-vs-backup">Replica vs Backup</h3>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1591725861122.png" alt="" loading="lazy"></figure>
<h3 id="sql">SQL</h3>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1591725986397.png" alt="" loading="lazy"></figure>
<h3 id="nosql">NoSQL</h3>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1591726102538.png" alt="" loading="lazy"></figure>
<h2 id="å®æˆ˜1user-table-sharding">å®æˆ˜1ï¼šUser Table Sharding</h2>
<p>æ€ä¹ˆå–æ•°æ®å°±æ€ä¹ˆæ‹†æ•°æ®åº“<br>
æŒ‰ç…§ usernameæ‰¾ç”¨æˆ· æŸ¥username-&gt;idè¡¨<br>
<img src="https://yueqingsheng.github.io/post-images/1591752365390.png" alt="" loading="lazy"></p>
<h2 id="å®æˆ˜2friendship-table-sharding">å®æˆ˜2ï¼šFriendship Table Sharding</h2>
<p>åŒå‘å¥½å‹å…³ç³»ï¼Œå¿…é¡»å­˜ä¸¤æ¡å…³ç³»</p>
<h2 id="å®æˆ˜4-news-feedtimeline-sharding">å®æˆ˜4ï¼š News Feed/Timeline Sharding</h2>
<p>owner id/userid</p>
<h2 id="å®æˆ˜5-lintcode-submission-userproblemstatus">å®æˆ˜5ï¼š LintCode Submission (user/problem/status)</h2>
<figure data-type="image" tabindex="4"><img src="https://yueqingsheng.github.io/post-images/1591753013575.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[éšæƒ³]]></title>
        <id>https://yueqingsheng.github.io/post/sui-xiang 2/</id>
        <link href="https://yueqingsheng.github.io/post/sui-xiang 2/">
        </link>
        <updated>2020-06-07T05:36:42.000Z</updated>
        <summary type="html"><![CDATA[<p>ä¼šè®°å½•ä¸€äº›çªç„¶æƒ³åˆ°çš„æƒ³æ³•åˆ°è¿™é‡Œ</p>
]]></summary>
        <content type="html"><![CDATA[<p>ä¼šè®°å½•ä¸€äº›çªç„¶æƒ³åˆ°çš„æƒ³æ³•åˆ°è¿™é‡Œ</p>
<!-- more -->
<h3 id="å¼€ä¼š">å¼€ä¼š</h3>
<p>ä¼šè®®ä¸­æœ‰å¤ªå¤šçš„å¹²æ‰°é¡¹ï¼Œå…·ä½“å®ç°çš„æ–¹æ¡ˆåº”è¯¥æ”¾åœ¨ä¼šè®®å‰å»åšã€‚å¤šäººçš„äº¤æµå’Œå¹²æ‰°ï¼Œåè€Œä¼šä½¿æƒ³å‡ºä¸€ä¸ªå¥½çš„è§£å†³æ–¹æ¡ˆçš„æ•ˆç‡é™ä½ã€‚</p>
<h3 id="é¡¹ç›®å®ä¼Ÿçš„ç¼ºé™·">é¡¹ç›®å®ä¼Ÿçš„ç¼ºé™·</h3>
<p>ä¸€äº›å®ä¼Ÿé¡¹ç›®æƒ³æ³•åœ¨æå‡ºæ¥çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¾ˆå¥½ã€‚ä½†æ˜¯åº”è¯¥åœ¨æ¯éƒ¨åˆ†çš„å®ç°é€»è¾‘ï¼ˆç»†èŠ‚ï¼‰å°½å¯èƒ½å®Œå–„åï¼ˆæƒ³å‡ºæ¥ï¼Œæˆ–è€…demoå®ç°ä¸€ä¸‹ï¼‰ï¼Œå†æ‹›è˜ç¨‹åºå‘˜å»åšã€‚</p>
<h3 id="bugè§£å†³æ–¹æ¡ˆ">bugè§£å†³æ–¹æ¡ˆ</h3>
<p>å½“å¡åœ¨æŸä¸ªbugè‡ªå·±çŸ­æ—¶é—´å†…æ— æ³•è§£å†³æ—¶ï¼Œæˆ–æ‰¾ä¸åˆ°åŸå› ï¼Œæœ€æœ‰æ•ˆç‡çš„æ–¹å¼æ˜¯å»æœç´¢è¿™ä¸ªé—®é¢˜ï¼ŒæŸ¥çœ‹åˆ«äººæ˜¯æ€ä¹ˆè§£å†³çš„ã€‚</p>
<h3 id="æ—¶é—´è§„åˆ’">æ—¶é—´è§„åˆ’</h3>
<p>å¯ä»¥ç»™è®¡åˆ’è®¾ä¸ªä¸‹é™å’Œä¸Šé™ï¼Œä»¥é¿å…è§„åˆ’æ²¡è¾¾åˆ°çš„å¿ƒé‡Œè½å·®ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[jupyter]]></title>
        <id>https://yueqingsheng.github.io/post/jupyter/</id>
        <link href="https://yueqingsheng.github.io/post/jupyter/">
        </link>
        <updated>2020-06-03T07:31:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="è‡ªåŠ¨è¾“å‡ºå¤šè¡Œ">è‡ªåŠ¨è¾“å‡ºå¤šè¡Œ</h2>
<p>from IPython.core.interactiveshell import InteractiveShell<br>
InteractiveShell.ast_node_interactivity = &quot;all&quot;</p>
<h2 id="å®‰è£…åŒ…-can-not-find-module">å®‰è£…åŒ… can not find module</h2>
<p>import sys<br>
!{sys.executable} -m pip install pypinyin</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç³»ç»Ÿè®¾è®¡ Week 2 Database&Cache(æ•°æ®åº“å’Œç¼“å­˜)]]></title>
        <id>https://yueqingsheng.github.io/post/xi-tong-she-ji-week-2-databaseandcacheshu-ju-ku-he-huan-cun/</id>
        <link href="https://yueqingsheng.github.io/post/xi-tong-she-ji-week-2-databaseandcacheshu-ju-ku-he-huan-cun/">
        </link>
        <updated>2020-06-02T20:51:55.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç”¨æˆ·ç³»ç»Ÿ">ç”¨æˆ·ç³»ç»Ÿ</h2>
<figure data-type="image" tabindex="1"><img src="https://yueqingsheng.github.io/post-images/1591478153289.png" alt="" loading="lazy"></figure>
<h2 id="scenarioqpsservice">Scenario(QPS)&amp;Service</h2>
<p>QPS = DAU*ç”¨æˆ·å¹³å‡æ¯å¤©è¯·æ±‚æ¬¡æ•°/æ¯å¤©å¤šå°‘ç§’ï¼ˆ86400ï¼‰<br>
<img src="https://yueqingsheng.github.io/post-images/1591552259685.png" alt="" loading="lazy"></p>
<h3 id="qpsä¸æ•°æ®å­˜å‚¨">QPSä¸æ•°æ®å­˜å‚¨</h3>
<figure data-type="image" tabindex="2"><img src="https://yueqingsheng.github.io/post-images/1591552392966.png" alt="" loading="lazy"></figure>
<h2 id="cacheè¯»å¤šå†™å°‘">Cacheï¼ˆè¯»å¤šå†™å°‘ï¼‰</h2>
<p>File system å¯ä»¥ä½œä¸ºç½‘ç»œè¯·æ±‚å’Œè®¡ç®—ç»“æœçš„cache<br>
è·ŸhashmapåŒºåˆ«ï¼Œcacheæœ‰æ·˜æ±°æœºåˆ¶ï¼ˆLRUï¼ŒLSUï¼‰<br>
<img src="https://yueqingsheng.github.io/post-images/1591559774530.png" alt="" loading="lazy"><br>
ttl: time to live<br>
<img src="https://yueqingsheng.github.io/post-images/1591593445593.png" alt="" loading="lazy"></p>
<h3 id="set-user">Set User</h3>
<p>cache delete, database set.æœ‰å¯èƒ½ç¬¬äºŒä¸ª<br>
<img src="https://yueqingsheng.github.io/post-images/1591593695552.png" alt="" loading="lazy"><br>
å¤šçº¿ç¨‹ä¸‹ï¼Œå¯èƒ½é€ æˆæ•°æ®ä¸ä¸€è‡´ã€‚<br>
å½“æ‰§è¡Œå®Œcache delete, å¦å¤–çº¿ç¨‹get user  è·å–äº†æ—§æ•°æ®ï¼ˆcacheï¼‰, å†æ‰§è¡Œdatabase set (æ–°æ•°æ®-&gt;æ•°æ®ä¸ä¸€è‡´<br>
<img src="https://yueqingsheng.github.io/post-images/1591594170682.png" alt="" loading="lazy"><br>
åŠ é”ï¼ˆä¸åŒæœºå™¨ï¼Œç³»ç»Ÿ)</p>
<h4 id="å¸¸ç”¨æ–¹æ³•">å¸¸ç”¨æ–¹æ³•</h4>
<p>database.set, cache.delete<br>
<img src="https://yueqingsheng.github.io/post-images/1591633218358.png" alt="" loading="lazy"><br>
åŒæ—¶ç”¨ set set, å¤šè¿›ç¨‹ä¼šæœ‰ä¿®æ”¹æ•°æ®åº“æƒ…å†µï¼Œç„¶åç¼“å­˜setæ—§çš„data<br>
ç¬¬ä¸€ç§æƒ…å†µå› ä¸ºè¯»å¤šæ”¹å°‘ï¼Œå‡ºç°æ¦‚ç‡ä½ã€‚cache hit æ¦‚ç‡å¤§ï¼Œé€šå¸¸&gt;98%</p>
<h3 id="å¦‚ä½•è§£å†³ä¸€è‡´æ€§-é—®é¢˜">å¦‚ä½•è§£å†³ä¸€è‡´æ€§ é—®é¢˜</h3>
<p>ttl(time to live) å…è®¸çŸ­æ—¶é—´çš„ä¸ä¸€è‡´</p>
<h3 id="è¯»å°‘å†™å¤š-å¤šç”¨æ•°æ®åº“åˆ†æ‘Šè¯·æ±‚">è¯»å°‘å†™å¤š ï¼ˆå¤šç”¨æ•°æ®åº“ï¼Œåˆ†æ‘Šè¯·æ±‚ï¼‰</h3>
<h4 id="cache-æ¶æ„">Cache æ¶æ„</h4>
<p><img src="https://yueqingsheng.github.io/post-images/1591633744350.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591633807994.png" alt="" loading="lazy"></p>
<h2 id="ç™»å½•ç³»ç»Ÿ">ç™»å½•ç³»ç»Ÿ</h2>
<figure data-type="image" tabindex="3"><img src="https://yueqingsheng.github.io/post-images/1591637241224.png" alt="" loading="lazy"></figure>
<blockquote>
<p>UUID:é€šå¸¸ç”¨UUIDæ¥ä½œä¸ºSession Key(Session Token)ï¼ŒUUID(Universal Unique ID): UUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—æ‰€æ„æˆï¼Œæ‰€ä»¥UUIDç†è®ºä¸Šçš„æ€»æ•°ä¸º16<sup>32=2</sup>128ï¼Œçº¦ç­‰äº3.4 x 10^38ã€‚ä¹Ÿå°±æ˜¯è¯´è‹¥æ¯çº³ç§’äº§ç”Ÿ1å…†ä¸ªUUIDï¼Œè¦èŠ±100äº¿å¹´æ‰ä¼šå°†æ‰€æœ‰UUIDç”¨å®Œã€‚æ‰€ä»¥é€šä¿—çš„ç§°ä¹‹ä¸ºå®‡å®™çˆ†ç‚¸éƒ½ä¸ä¼šå‡ºç°é‡å¤çš„IDå­—æ®µã€‚<br>
<img src="https://yueqingsheng.github.io/post-images/1591637779482.png" alt="" loading="lazy"><br>
Cookieé‡Œå†…å®¹è¶Šå°‘è¶Šå¥½</p>
</blockquote>
<h3 id="åªå…è®¸ä¸€å°æœºå™¨ç™»å½•">åªå…è®¸ä¸€å°æœºå™¨ç™»å½•</h3>
<p>å­˜å‚¨device token, ç›‘æµ‹åˆ°ä¸åŒdevice, æŠŠå…¶ä»–è®¾å¤‡è´¦æˆ·logout</p>
<h2 id="å¥½å‹å…³ç³»">å¥½å‹å…³ç³»</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591638752848.png" alt="" loading="lazy"><br>
æ–¹æ¡ˆ1:<br>
ä¼˜ç‚¹ï¼šåªå­˜å‚¨1æ¡æ•°æ®ï¼ŒèŠ‚çœä¸€åŠç©ºé—´ã€‚ï¼ˆå½“ä½ è¦å­˜ 1 å’Œ 2 æ˜¯å¥½å‹çš„æ—¶å€™ï¼Œä½ å¯èƒ½å­˜ä¸º &lt;1,2&gt; ä¹Ÿå¯èƒ½å­˜ä¸º &lt;2,1&gt;ã€‚æˆ‘ä»¬åªå­˜æˆ &lt;1,2&gt; çš„å½¢å¼ï¼ŒåŸå› æœ‰ä¸¤ä¸ªï¼Œç¬¬ä¸€æ˜¯æ–¹ä¾¿æŸ¥è¯¢ï¼Œå¦åˆ™ä½ æŸ¥è¯¢çš„æ—¶å€™å¾—åˆ†åˆ«å·® &lt;1,2&gt; æ˜¯å¦å­˜åœ¨å’Œ &lt;2,1&gt; æ˜¯å¦å­˜åœ¨ã€‚ç¬¬äºŒä¸ªæ˜¯èŠ‚çœä¸€åŠçš„å­˜å‚¨ç©ºé—´ã€‚ï¼‰<br>
ç¼ºç‚¹ï¼š æŸ¥è¯¢æ—¶ or æ“ä½œæ…¢ä¸€äº›<br>
æ–¹æ¡ˆ2:<br>
ä¼˜ç‚¹ï¼š æŸ¥è¯¢è¯­å¥ç®€å•ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ã€‚ç©ºé—´æ¢å–æ—¶é—´</p>
<blockquote>
<p>Transaction: äº‹åŠ¡ã€‚ä»£è¡¨ä¸€äº›åˆ—æ“ä½œè¦æ‰“åŒ…åœ¨ä¸€èµ·ï¼ŒåŒæ—¶æˆæœæˆ–è€…åŒæ—¶å¤±è´¥ã€‚æ¯”å¦‚æˆ‘è½¬ä½  10 å—é’±ï¼Œä½ çš„ä½™é¢è¦ +10ï¼Œæˆ‘çš„ä½™é¢è¦ -10ã€‚è¿™æ˜¯ä¸¤æ¡æ•°æ®åº“æ“ä½œï¼Œå¿…é¡»åŒæ—¶æˆåŠŸæˆ–è€…åŒæ—¶å¤±è´¥ã€‚ä¸èƒ½åªæœ‰ä¸€æ¡æ“ä½œæˆåŠŸã€‚è¿™ç§æ‰“åŒ…ï¼Œå°±å«åš Transactionã€‚</p>
</blockquote>
<h2 id="nosqlcassandra">NoSQL(Cassandra)</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591639493129.png" alt="" loading="lazy"><br>
Row key: å­˜å‚¨åˆ°å“ªå°æœºå™¨çš„ç´¢å¼•ï¼Œnosql ç”¨äºåˆ†å¸ƒå¼<br>
<img src="https://yueqingsheng.github.io/post-images/1591643551418.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591645626931.png" alt="" loading="lazy"><br>
Column key: æ”¯æŒèŒƒå›´æŸ¥è¯¢ å’Œ å¤åˆå€¼æŸ¥è¯¢</p>
<h2 id="nosql-vs-sql">NoSQL VS SQL</h2>
<p><img src="https://yueqingsheng.github.io/post-images/1591649259941.png" alt="" loading="lazy"><br>
<img src="https://yueqingsheng.github.io/post-images/1591649307923.png" alt="" loading="lazy"></p>
<h3 id="é€‰æ‹©åŸåˆ™">é€‰æ‹©åŸåˆ™ï¼š</h3>
<ol>
<li>transaction ä¸èƒ½é€‰NoSQL(é€šå¸¸åœ¨ä¸€å°æœºå™¨å®Œæˆ)</li>
<li>æ“…é•¿éƒ¨åˆ†</li>
<li>ä¸€ä¸ªç½‘ç«™ä¼šä½¿ç”¨å¤šç§æ•°æ®åº“<br>
<img src="https://yueqingsheng.github.io/post-images/1591649707668.png" alt="" loading="lazy"></li>
</ol>
<h2 id="nosql-å­˜å•å‘å¥½å‹å…³ç³»">NoSql å­˜å•å‘å¥½å‹å…³ç³»</h2>
<figure data-type="image" tabindex="4"><img src="https://yueqingsheng.github.io/post-images/1591751464392.png" alt="" loading="lazy"></figure>
<h2 id="nosql-å­˜å‚¨user">NoSql å­˜å‚¨User</h2>
<p>æ ¹æ® emial/phone/usernameæŸ¥è¯¢<br>
<img src="https://yueqingsheng.github.io/post-images/1591751772270.png" alt="" loading="lazy"></p>
<h2 id="å…±åŒå¥½å‹">å…±åŒå¥½å‹</h2>
<p>A userid B userid =&gt; Aå’ŒBäº¤é›†<br>
<img src="https://yueqingsheng.github.io/post-images/1591751952888.png" alt="" loading="lazy"></p>
<h2 id="å…­åº¦å…³ç³»">å…­åº¦å…³ç³»</h2>
<figure data-type="image" tabindex="5"><img src="https://yueqingsheng.github.io/post-images/1591752010561.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
</feed>